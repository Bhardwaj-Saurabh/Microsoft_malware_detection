'''
This module contains the class for reading microsoftmalware data

Author: Saurabh bhardwaj
Date: Oct 2023
'''

# import necessary libraries
import sys
import pandas as pd
from src.constant.training_pipeline import FILE_PATH
from src.exception import MalwareException
from src.logger import logging

class MicrosoftMalwareData:
    """
    This class helps export the entire dataset record as a pandas DataFrame.
    """

    def __init__(self, file_path=FILE_PATH):
        """
        Initializes a MicrosoftMalwareData instance.

        Args:
            file_path (str): The path to the CSV file containing the data.

        Raises:
            MalwareException: If an error occurs during initialization.
        """
        try:
            self.file_path = file_path
        except Exception as e:
            raise MalwareException(e, sys)

    def read_data(self) -> pd.DataFrame:
        """
        Reads the data from the CSV file and returns it as a pandas DataFrame.

        Returns:
            pd.DataFrame: The dataset as a pandas DataFrame.

        Raises:
            MalwareException: If an error occurs while reading the data.
        """
        try:
            logging.info("Reading data from CSV file")
            # read data from csv file and return it as a pandas DataFrame
            # set nrows to 4000000 to reduce memory usage
            # set low_memory to False to avoid truncation of large numbers
            malware_data = pd.read_csv(self.file_path, nrows=100000, low_memory=False)
            return malware_data
        except Exception as e:
            raise MalwareException(e, sys)


