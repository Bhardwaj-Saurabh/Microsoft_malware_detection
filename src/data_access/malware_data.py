import sys
import numpy as np
import pandas as pd
from src.constant.training_pipeline import FILE_PATH
from src.exception import MalwareException
from src.logger import logging

class MicrosoftMalwareData:
    """
    This class help to export entire mongo db record as pandas dataframe
    """
    def __init__(self, file_path:FILE_PATH):
        """
        DataFrame management
        """
        try:
            self.file_path = file_path
        except Exception as e:
            raise MalwareException(e, sys)
        
    def read_data(self)-> pd.DataFrame:
        """
        Return dataset as pandas dataframe
        """
        try:
            df = pd.read_csv(self.file_path, nrows=50000)
            return df
        except Exception as e:
            raise MalwareException(e, sys)


